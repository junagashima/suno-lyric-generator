# 段階3改善計画書

## 課題と修正方針

### 課題1: 年齢設定概念修正
**問題**: ターゲット年齢層 → **修正**: ボーカリストの年齢
- データ構造変更: AgeRange → VocalistAge
- UI表記変更: "ターゲット年齢層" → "ボーカリストの年齢"
- キーワード変更: ターゲット向け → ボーカリストの特徴

### 課題2: 楽曲長設定統一
**問題**: 独自3パターン → **修正**: こだわりモードと同じ設定
- 既存のsongLength stateを活用
- 独自SongLength型を削除
- こだわりモードの選択肢をそのまま使用

### 課題3: UI配置・画面ジャンプ修正
**UI配置修正**:
1. 推奨設定表示
2. 個別要素選択（編集モード時）
3. SUNO最適化設定（最下部）

**画面ジャンプ修正**:
- SUNO最適化/従来方式ボタンにtype="button"追加
- フォーカス制御の最適化

## 修正手順（安全性重視）

### ステップ1: バックアップ作成
- 現在の段階3実装を完全バックアップ
- 段階1-2機能の保護

### ステップ2: データ構造修正
- 年齢関連の型・データを修正
- 楽曲長独自実装を削除

### ステップ3: UI修正
- レイアウト順序変更
- ボタンtype属性追加

### ステップ4: 既存設定との統合
- こだわりモードの楽曲長設定を活用
- 重複コードの除去

### ステップ5: テスト・確認
- 段階1-2機能の動作確認
- 新機能の動作確認
- 画面ジャンプ問題の解消確認

### ステップ6: コミット・PR更新
- 修正内容をコミット
- PRを更新

## 安全性対策
- 段階1-2機能への影響最小化
- 段階的な修正による問題の早期発見
- バックアップによる復旧可能性確保
